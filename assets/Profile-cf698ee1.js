var xe=Object.defineProperty;var ve=(a,t,s)=>t in a?xe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var x=(a,t,s)=>(ve(a,typeof t!="symbol"?t+"":t,s),s);import{ar as M,q as V,o as W,s as K,i as j,B as T,t as je,L as fe,E as ue,k as ge,K as Ne,as as g,at as w,J as ye,H as _e,u as F,j as e,b as B,d as Q,r as f,G as be,a7 as U,au as Pe,P as X,N as Se,e as Y,ad as J,ac as ke,av as Le,a4 as y,aw as Ee,a8 as we,a9 as De,aa as Re,ab as Oe,Z as D,ax as H,$ as Ge,an as Te,R as Ce,ay as Ae,a1 as $e,Q as Fe}from"./index-0ef7cbf5.js";import{c as C}from"./index-90441374.js";import{T as v,G as Be,_ as Ie}from"./Tooltip-a70a5681.js";import{a as Me,G as He,D as qe}from"./GradesGraph-ee6c6801.js";import{r as A,E as $,g as ze}from"./ExpRankImg-3874ecc3.js";import{S as _}from"./Stack-cbf22778.js";import{R as Z,X as ee,Y as se,T as re}from"./BarChart-a3538816.js";import{L as ae,C as te,a as ie,w as Ve,p as We,P as Ke}from"./PlayerCompareSelect-28462da7.js";import{T as Qe}from"./Toggle-c418315b.js";function Ue(a,t){return a in t.breakpoints?M(t.breakpoints[a]):M(a)}function Xe(a,t){const s=a.map(r=>({value:r,px:Ue(r,t)}));return s.sort((r,i)=>r.px-i.px),s}function R(a){return typeof a=="object"&&a!==null?"base"in a?a.base:void 0:a}var Ye={root:"m-3eebeb36",label:"m-9e365f20"};const ne=Ye;var Je=Object.defineProperty,Ze=Object.defineProperties,es=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,q=(a,t,s)=>t in a?Je(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,O=(a,t)=>{for(var s in t||(t={}))le.call(t,s)&&q(a,s,t[s]);if(P)for(var s of P(t))oe.call(t,s)&&q(a,s,t[s]);return a},ss=(a,t)=>Ze(a,es(t)),rs=(a,t)=>{var s={};for(var r in a)le.call(a,r)&&t.indexOf(r)<0&&(s[r]=a[r]);if(a!=null&&P)for(var r of P(a))t.indexOf(r)<0&&oe.call(a,r)&&(s[r]=a[r]);return s};const as={orientation:"horizontal"},ts=je((a,{color:t,variant:s,size:r})=>({root:{"--divider-color":t?fe(t,a):void 0,"--divider-border-style":s,"--divider-size":ue(r,"divider-size")}})),S=V((a,t)=>{const s=W("Divider",as,a),r=s,{classNames:i,className:n,style:c,styles:o,unstyled:p,vars:m,color:d,orientation:l,label:h,labelPosition:L}=r,E=rs(r,["classNames","className","style","styles","unstyled","vars","color","orientation","label","labelPosition"]),u=K({name:"Divider",classes:ne,props:s,className:n,style:c,classNames:i,styles:o,unstyled:p,vars:m,varsResolver:ts});return j.createElement(T,ss(O(O({ref:t,mod:{orientation:l,"with-label":!!h}},u("root")),E),{role:"separator"}),h&&j.createElement(T,O({component:"span",mod:{position:L}},u("label")),h))});S.classes=ne;S.displayName="@mantine/core/Divider";function is({spacing:a,verticalSpacing:t,cols:s,selector:r}){var i;const n=ge(),c=t===void 0?a:t,o=Ne({"--sg-spacing-x":g(R(a)),"--sg-spacing-y":g(R(c)),"--sg-cols":(i=R(s))==null?void 0:i.toString()}),p=w(n.breakpoints).reduce((l,h)=>(l[h]||(l[h]={}),typeof a=="object"&&a[h]!==void 0&&(l[h]["--sg-spacing-x"]=g(a[h])),typeof c=="object"&&c[h]!==void 0&&(l[h]["--sg-spacing-y"]=g(c[h])),typeof s=="object"&&s[h]!==void 0&&(l[h]["--sg-cols"]=s[h]),l),{}),d=Xe(w(p),n).filter(l=>w(p[l.value]).length>0).map(l=>({query:`(min-width: ${n.breakpoints[l.value]})`,styles:p[l.value]}));return j.createElement(ye,{styles:o,media:d,selector:r})}var ns={root:"m-2415a157"};const ce=ns;var ls=Object.defineProperty,os=Object.defineProperties,cs=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,z=(a,t,s)=>t in a?ls(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,G=(a,t)=>{for(var s in t||(t={}))de.call(t,s)&&z(a,s,t[s]);if(k)for(var s of k(t))he.call(t,s)&&z(a,s,t[s]);return a},ds=(a,t)=>os(a,cs(t)),hs=(a,t)=>{var s={};for(var r in a)de.call(a,r)&&t.indexOf(r)<0&&(s[r]=a[r]);if(a!=null&&k)for(var r of k(a))t.indexOf(r)<0&&he.call(a,r)&&(s[r]=a[r]);return s};const ps={cols:1,spacing:"md"},I=V((a,t)=>{const s=W("SimpleGrid",ps,a),r=s,{classNames:i,className:n,style:c,styles:o,unstyled:p,vars:m,cols:d,verticalSpacing:l,spacing:h}=r,L=hs(r,["classNames","className","style","styles","unstyled","vars","cols","verticalSpacing","spacing"]),E=K({name:"SimpleGrid",classes:ce,props:s,className:n,style:c,classNames:i,styles:o,unstyled:p,vars:m}),u=_e();return j.createElement(j.Fragment,null,j.createElement(is,ds(G({},s),{selector:`.${u}`})),j.createElement(T,G(G({ref:t},E("root",{className:u})),L)))});I.classes=ce;I.displayName="@mantine/core/SimpleGrid";const ms=()=>{const a=F();return e.jsxs("article",{children:[e.jsx(v,{children:a.EXP_FAQ}),e.jsx(S,{my:"0.5em"}),e.jsx(v,{children:a.EXP_TITLES_LIST_HEADER}),e.jsx(S,{my:"0.5em"}),e.jsx(I,{cols:9,children:A.map((t,s)=>e.jsxs(_,{align:"center",gap:"0.25em",children:[e.jsx("div",{style:{width:"3em"},children:e.jsx($,{rankIndex:s})}),e.jsx(v,{size:"xs",children:t.threshold})]},t.threshold))})]})},xs="_expLine_qee59_1",vs="_taken_qee59_7",js="_rest_qee59_12",fs="_expLineBlock_qee59_17",N={expLine:xs,taken:vs,rest:js,expLineBlock:fs},us=()=>{var m;const a=B(),t=F(),s=a.id?Number(a.id):void 0,{data:r}=Q.players.stats.useQuery(),i=(m=r==null?void 0:r.find(d=>d.id===s))==null?void 0:m.exp;if(i==null)return null;const n=ze(i),c=A[n],o=A[n+1],p=o?(i-c.threshold)/((o==null?void 0:o.threshold)-c.threshold):1;return e.jsxs(Be,{pl:"sm",pr:"sm",pb:"sm",children:[e.jsxs(_,{align:"center",gap:"0.25em",w:"2.5em",children:[e.jsx($,{rankIndex:n}),e.jsx(v,{size:"0.6rem",children:c.threshold})]}),e.jsxs(_,{align:"center",gap:"0",className:N.expLineBlock,children:[o?e.jsxs("span",{children:[e.jsx(v,{size:"sm",span:!0,c:"gold",children:Math.floor(i-c.threshold)}),e.jsxs(v,{size:"sm",span:!0,children:[" ","/ ",o.threshold-c.threshold]})]}):null,e.jsxs("div",{className:N.expLine,children:[e.jsx("div",{className:N.taken,style:{width:Math.floor(100*p)+"%"}}),e.jsx("div",{className:N.rest,style:{width:100-Math.ceil(100*p)+"%"}})]}),e.jsx("span",{children:e.jsxs(v,{size:"sm",span:!0,children:[t.TOTAL,":"," ",e.jsx(v,{span:!0,c:"gold",inherit:!0,children:i})]})})]}),o&&e.jsxs(_,{align:"center",gap:"0.25em",w:"2.5em",children:[e.jsx($,{rankIndex:n+1}),e.jsx(v,{size:"0.6rem",children:o.threshold})]})]})},pe=({playerId:a})=>Q.players.pp.useQuery(a),gs=()=>{const a=B(),{data:t}=pe({playerId:a.id?Number(a.id):void 0}),s=f.useMemo(()=>t==null?void 0:t.history.map(r=>({date:new Date(r.date).getTime(),pp:parseFloat(r.pp)})),[t==null?void 0:t.history]);return s?e.jsx(Z,{aspect:1.6,children:e.jsxs(ae,{data:s,margin:{top:5,bottom:5,right:5,left:0},children:[e.jsx(te,{strokeDasharray:"3 3"}),e.jsx(ee,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:r=>new Date(r).toLocaleDateString()}),e.jsx(se,{allowDecimals:!1,domain:([r,i])=>[Math.max(0,r-100),i+100],tickFormatter:r=>`${Math.round(r)}`,width:40}),e.jsx(re,{isAnimationActive:!1,content:({payload:r})=>!r||!r[0]?null:e.jsxs("div",{className:"history-tooltip",children:[e.jsx("div",{children:new Date(r[0].payload.date).toLocaleDateString()}),r&&r[0]&&e.jsxs("div",{children:["PP: ",r[0].value]})]})}),e.jsx(ie,{type:"monotone",isAnimationActive:!1,dataKey:"pp",stroke:"#88d3ff",strokeWidth:3,dot:!1})]})}):null},Ns=()=>{const a=B(),{data:t}=pe({playerId:a.id?Number(a.id):void 0}),s=f.useMemo(()=>t==null?void 0:t.rankHistory.map(r=>({date:new Date(r.date).getTime(),rank:r.rank})),[t==null?void 0:t.rankHistory]);return s?e.jsx(Z,{aspect:1.6,children:e.jsxs(ae,{data:s,margin:{top:5,bottom:5,right:5,left:0},children:[e.jsx(te,{strokeDasharray:"3 3"}),e.jsx(ee,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:r=>new Date(r).toLocaleDateString()}),e.jsx(se,{allowDecimals:!1,domain:([,r])=>[1,r<3?r+2:r+1],interval:0,reversed:!0,width:40}),e.jsx(re,{isAnimationActive:!1,content:({payload:r})=>!r||!r[0]?null:e.jsxs("div",{className:"history-tooltip",children:[e.jsx("div",{children:new Date(r[0].payload.date).toLocaleDateString()}),r&&r[0]&&e.jsxs("div",{children:["Place: #",r[0].value]})]})}),e.jsx(ie,{isAnimationActive:!1,type:"stepAfter",dataKey:"rank",stroke:"#88d3ff",strokeWidth:3,dot:!1})]})}):null},ys=j.memo(function({grade:t}){return!t||t==="?"?null:e.jsx("img",{src:`/grades/${t}.png`,alt:t})});function _s(a){return be({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}}]})(a)}const bs=U(a=>({charts:a.results.sharedCharts}),{fetchJson:Ee})(({playerId:a,charts:t,fetchJson:s})=>{const[r,i]=f.useState(!1),[n,c]=f.useState(10),[o,p]=f.useState([]),m=F();return f.useEffect(()=>{i(!0),s({url:`${Pe}/player/${a}/mostPlayed?limit=${n}`}).then(d=>{i(!1),d.success&&p(d.data)}).catch(()=>{i(!1)})},[a,n,s]),e.jsxs("div",{className:"most-played",children:[r&&e.jsx(X,{}),o.map(d=>{const l=t[d.shared_chart];return l?e.jsxs("div",{className:"chart",children:[e.jsxs("div",{className:C("chart-name",{single:l.chartType==="S",singlep:l.chartType==="SP",doublep:l.chartType==="DP",double:l.chartType==="D",coop:l.chartType==="COOP"}),children:[e.jsx("span",{className:"chart-letter",children:l.chartType}),e.jsx("span",{className:"chart-number",children:l.chartLevel})]}),e.jsx("div",{className:"song-name",children:e.jsx(Se,{exact:!0,to:Y.leaderboard.sharedChart.getPath({sharedChartId:l.sharedChartId}),children:l.song})}),e.jsx("div",{className:"date",children:d.latestDate?J(m,ke(d.latestDate)):null}),e.jsxs("div",{className:"playcount",children:[e.jsx(Le,{}),e.jsx("span",{children:d.count})]})]},d.shared_chart):null}),n===y.size(o)&&e.jsxs("button",{className:"show-more btn btn-sm btn-dark btn-icon",onClick:()=>c(n+10),children:[e.jsx(_s,{})," ",m.SHOW_MORE]})]})}),me=We("id"),Ps=(a,t)=>({profile:me(a,t),tracklist:a.tracklist.data,filter:a.profiles.filter,error:a.charts.error||a.tracklist.error,sharedCharts:a.results.sharedCharts,isLoading:a.charts.isLoading||a.results.isLoadingRanking||a.tracklist.isLoading}),Ss={fetchChartsData:we,setProfilesFilter:De,resetProfilesFilter:Re};class b extends f.Component{constructor(){super(...arguments);x(this,"state",{isLevelGraphCombined:!0,showFaq:!1});x(this,"onRefresh",()=>{const{isLoading:s}=this.props;!s&&this.props.fetchChartsData()});x(this,"onChangeDayRange",s=>{const{filter:r}=this.props;this.props.setProfilesFilter({...r,dayRange:s})});x(this,"onShowFaq",()=>{this.setState({showFaq:!0})});x(this,"onHideFaq",()=>{this.setState({showFaq:!1})});x(this,"circleShape",s=>e.jsx("circle",{cx:s.cx,cy:s.cy,r:4,fill:s.fill},s.key))}componentWillUnmount(){this.props.resetProfilesFilter()}renderRankingHistory(){return e.jsx(gs,{})}renderPlaceHistory(){return e.jsx(Ns,{})}renderGrades(){return e.jsx(Me,{})}renderGradesWithLevels(){return e.jsx(He,{})}renderLevels(){return e.jsx(qe,{})}renderGradeBlock(s,r){const{profile:i}=this.props,n=i.progress[s],c=s==="double"?"D":"S",o=Math.floor((n[`${r}-bonus-level-coef`]||0)*100),p=n[`${r}-bonus-level-min-number`],m=n[`${r}-bonus-level-achieved-number`],d=n[`${r}-bonus-level`]?`${c}${n[`${r}-bonus-level`]}`:"?";return e.jsxs("div",{className:"grade-block",children:[e.jsx("div",{className:"grade-letter",children:e.jsx(ys,{grade:r})}),e.jsx("div",{className:"grade-level",children:d}),e.jsxs("div",{className:"grade-progress",children:[o,"% (",o===100?p:m,"/",p,")"]}),e.jsx("div",{className:C("progress-background",{complete:o===100,zero:o===0}),style:{height:`${o}%`}})]})}renderAchievement(s,r){const i=H[s].icon,n=H[s].description;return e.jsx(Ie,{content:e.jsx("div",{children:n}),tooltipClassName:"pumpking-tooltip achievement-tooltip",children:e.jsxs("div",{className:"ach-block",children:[i&&e.jsx("div",{className:"ach-icon",children:e.jsx(i,{})}),e.jsx("div",{className:"ach-name",children:s}),e.jsx("div",{className:C("progress-background",{complete:r.progress===100,zero:r.progress===0}),style:{height:`${Math.round(r.progress)}%`}})]})},s)}renderResultsByLevelHeader(){const s=this.context,{isLevelGraphCombined:r}=this.state;return e.jsx("div",{className:"toggle-holder",children:e.jsx(Qe,{className:"combine-toggle",checked:r,onChange:()=>this.setState(i=>({isLevelGraphCombined:!i.isLevelGraphCombined})),children:s.UNITE_GRAPHS})})}renderResultsByLevelFooter(){const s=this.context,{profile:r}=this.props;return e.jsx("div",{className:"toggle-holder",children:e.jsx(Ge,{to:Y.profile.resultsByLevel.getPath({id:r.id}),children:e.jsx("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",children:s.MORE_DETAILS})})})}renderProfile(){const s=this.context,{profile:r}=this.props,{isLevelGraphCombined:i}=this.state;return r.expRankNext&&(r.exp-r.expRank.threshold)/(r.expRankNext.threshold-r.expRank.threshold),e.jsxs("div",{className:"profile",children:[e.jsxs("div",{className:"profile-header",children:[e.jsxs("div",{className:"profile-name text-with-header",children:[e.jsx("div",{className:"text-header",children:s.PLAYER}),e.jsx("div",{children:r.name})]}),e.jsxs("div",{className:"text-with-header",children:[e.jsx("div",{className:"text-header",children:s.RANK}),e.jsxs("div",{children:["#",r.rank]})]}),e.jsxs("div",{className:"text-with-header",children:[e.jsx("div",{className:"text-header",children:s.PP}),e.jsx("div",{children:Math.floor(r.pp)})]}),e.jsxs("div",{className:"text-with-header",children:[e.jsx("div",{className:"text-header",children:s.LAST_TIME_PLAYED}),e.jsx("div",{children:r.lastResultDate?J(s,r.lastResultDate):s.NEVER})]}),e.jsx("div",{className:"_flex-fill"}),e.jsxs("div",{className:"text-with-header -select",children:[e.jsx("div",{className:"text-header",children:s.COMPARE_WITH}),e.jsx("div",{children:e.jsx(Ke,{})})]})]}),e.jsxs("div",{className:"profile-section",children:[e.jsxs("div",{className:"profile-sm-section-header _flex-row _align-center",children:[e.jsx("span",{children:s.EXP}),e.jsx("div",{className:"_flex-fill"}),e.jsx("div",{onClick:this.onShowFaq,className:"_clickable",children:e.jsx(Te,{onClick:this.onShowFaq})}),e.jsxs(Ce,{ariaHideApp:!1,className:"Modal faq-modal",overlayClassName:"Overlay",isOpen:this.state.showFaq,onRequestClose:this.onHideFaq,children:[e.jsx("div",{className:"close-btn",onClick:this.onHideFaq,children:e.jsx(Ae,{})})," ",e.jsx(ms,{})]})]}),e.jsx(us,{})]}),e.jsxs("div",{className:"profile-section-horizontal-container",children:[e.jsx("div",{className:"profile-section",children:e.jsx("div",{className:"profile-section-content",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"profile-section-2",children:[e.jsxs("div",{className:"profile-sm-section-header flex",children:[e.jsx("span",{children:s.GRADES}),this.renderResultsByLevelHeader()]}),e.jsx("div",{className:"chart-container single-double-labels",children:this.renderGradesWithLevels()})]}),this.renderResultsByLevelFooter()]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"profile-section-2",children:[e.jsxs("div",{className:"profile-sm-section-header flex",children:[e.jsx("span",{children:"уровни"}),this.renderResultsByLevelHeader()]}),e.jsx("div",{className:"chart-container",children:this.renderLevels()})]}),e.jsxs("div",{className:"profile-section-2",children:[e.jsx("div",{className:"profile-sm-section-header",children:e.jsx("span",{children:s.GRADES})}),e.jsx("div",{className:"chart-container",children:this.renderGrades()})]}),this.renderResultsByLevelFooter()]})})}),e.jsx("div",{className:"profile-section",children:e.jsxs("div",{className:"profile-section-content",children:[e.jsxs("div",{className:"profile-section-2",children:[e.jsx("div",{className:"profile-sm-section-header",children:e.jsx("span",{children:s.PP})}),e.jsx("div",{className:"chart-container",children:this.renderRankingHistory()})]}),e.jsxs("div",{className:"profile-section-2",children:[e.jsx("div",{className:"profile-sm-section-header",children:e.jsx("span",{children:s.PLACE_IN_TOP})}),e.jsx("div",{className:"chart-container",children:this.renderPlaceHistory()})]})]})})]}),e.jsxs("div",{className:"profile-section progress-section",children:[e.jsx("div",{className:"profile-sm-section-header",children:e.jsx("span",{children:s.LEVEL_ACHIEVEMENTS})}),e.jsxs("div",{className:"progress-blocks-single-double",children:[e.jsx("div",{className:"progress-block",children:e.jsxs("div",{className:"achievements-grades single",children:[this.renderGradeBlock("single","A"),this.renderGradeBlock("single","A+"),this.renderGradeBlock("single","S"),this.renderGradeBlock("single","SS")]})}),e.jsx("div",{className:"progress-block",children:e.jsxs("div",{className:"achievements-grades double",children:[this.renderGradeBlock("double","A"),this.renderGradeBlock("double","A+"),this.renderGradeBlock("double","S"),this.renderGradeBlock("double","SS")]})})]}),e.jsx("div",{className:"bonus-faq",children:s.LEVEL_ACHIEVEMENTS_HINT})]}),e.jsxs("div",{className:"profile-section",children:[e.jsx("div",{className:"profile-sm-section-header",children:e.jsx("span",{children:s.ACHIEVEMENTS})}),e.jsx("div",{className:"achievements",children:y.keys(r.achievements).map(n=>this.renderAchievement(n,r.achievements[n]))})]}),e.jsxs("div",{className:"profile-section",children:[e.jsx("div",{className:"profile-sm-section-header",children:e.jsx("span",{children:s.MOST_PLAYED_CHARTS})}),e.jsx(bs,{playerId:r.id})]})]})}render(){const{isLoading:s,profile:r,error:i}=this.props;$e&&console.log("profile:",r);const n=this.context;return e.jsx("div",{className:"profile-page",children:e.jsxs("div",{className:"content",children:[i&&i.message,e.jsxs("div",{className:"top-controls",children:[e.jsx("div",{className:"_flex-fill"}),e.jsxs("button",{disabled:s,className:"btn btn-sm btn-dark btn-icon",onClick:this.onRefresh,children:[e.jsx(Fe,{})," ",n.UPDATE]})]}),s&&e.jsx(X,{}),!s&&y.isEmpty(r)&&e.jsx("div",{className:"profile",children:n.PROFILE_NOT_FOUND}),!s&&!y.isEmpty(r)&&this.renderProfile()]})})}}x(b,"contextType",Oe),x(b,"propTypes",{profile:D.object,error:D.object,isLoading:D.bool.isRequired}),x(b,"defaultProps",{profile:{}});const ks=Ve(U(Ps,Ss)(b)),$s=Object.freeze(Object.defineProperty({__proto__:null,default:ks,profileSelector:me},Symbol.toStringTag,{value:"Module"}));export{ys as G,$s as P,me as p};
//# sourceMappingURL=Profile-cf698ee1.js.map
