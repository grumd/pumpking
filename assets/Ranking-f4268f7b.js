import{c as f,d as h,g as u,j as s,u as b,_ as m,O as p,N as j,e as N,af as g,ag as o,X as v,a3 as A,P as C}from"./index-82be7e26.js";import{u as Q}from"./useUser-0a819e21.js";import{c as R}from"./index-5cbd7a7b.js";import{l as y}from"./index.esm-96282398.js";import{E}from"./ExpRankImg-799de5a2.js";import{F as P}from"./index-4cfc1a13.js";import{T as _}from"./Toggle-497083c0.js";const q=()=>{const n=f();return h.user.preferencesMutation.useMutation({onSuccess:a=>{n.setQueryData(u(h.user.current,void 0,"query"),a),n.invalidateQueries(u(h.charts.search))}})};function S(){return s.jsxs("div",{className:"faq",children:[s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Как считается рейтинг?"}),s.jsxs("div",{className:"answer",children:["A: Используется ",s.jsx("a",{href:"https://en.wikipedia.org/wiki/Elo_rating_system",children:"рейтинг Эло"}),", широко используемый в шахматах и других играх, слегка модицированный под условия игры на пампе. Средний рейтинг - 1000. Коэффициент К зависит от уровня чарта (более сложные чарты сильнее влияют на рейтинг). Количество очков влияет на заработанный рейтинг (маленький отрыв от противника не даст так много очков как большой отрыв)."]})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Что такое рр и чем оно отличается от эло?"}),s.jsxs("div",{className:"answer",children:["A: РР (performance points) - система очков, взятая из osu!. Эло - система рейтинга, взятая из шахмат. Основные отличия:",s.jsx("br",{}),"С эло твои очки зависят от других игроков на этом чарте, с рр твои очки зависят только от того, как ты сыграешь чарт.",s.jsx("br",{}),"С эло можно потерять очки или заставить другого игрока их потерять, с рр можно только набирать больше очков.",s.jsx("br",{}),"С эло намного проще кого-то обогнать, с рр люди редко меняются местами в рейтинге.",s.jsx("br",{}),"Эло показывает кто кого обыгрывает в последнее время, а рр показывает, кто на каком примерно уровне по скиллу.",s.jsx("br",{}),"Сейчас рейтинг сортируется по Эло. РР выступает в качестве дополнительной инфы для интереса, плюс используется как стартовое значение Эло."]})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Система Эло используется для игр 1 на 1, как она используется на пампе, где на одном чарте играет много игроков?"}),s.jsx("div",{className:"answer",children:"A: Рекорды на одном чарте делятся на несколько игр 1 на 1. Если есть 3 игрока: A, B, C; то считается, что было 3 отдельные игры: A vs B, A vs C, B vs C."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Как считается сумма рр?"}),s.jsx("div",{className:"answer",children:"A: Сначала все скоры игрока сортируются по рр. Затем в общую сумму рр добавляется 100% от лучшего скора, 95% от второго скора, 90% от третьего, 86% от 4-го и так далее. (Формула коэффициента - 0.95^N). Таким образом, на общую сумму рр больше всего влияют самые лучшие результаты человека за всё время, и чтобы поднять свой уровень рр, нужно получать новые топовые результаты (и поднимать свой скилл)."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Учитываются ли рекорды на ранке в рейтинге?"}),s.jsx("div",{className:"answer",children:"A: Да. Как минимум потому что у нас есть много рекордов, взятых с машин бестов, и мы не знаем наверняка, на ранке они или нет. Если у игрока в топе есть два скора - на ранке и без ранка, используется тот, где больше очков."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Почему меня нет в рейтинге?"}),s.jsx("div",{className:"answer",children:"A: В таблицу попадают только те, у кого есть хотя бы 20 игр 1 на 1. Первые 20 игр используются для определения изначального рейтинга."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Почему суммарное количество оценок S-A-B не совпадает с общим количеством скоров?"}),s.jsx("div",{className:"answer",children:"A: Не для каждого результата известна оценка."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Если у меня есть несколько рекордов на А, несколько на А+, как считается суммарное количество грейдов в таблице?"}),s.jsx("div",{className:"answer",children:"A: В каждой колонке учитываются обе буквы - и треснутые, и с удержанным лайфом. То есть и А, и А+ идут в колонку А. Точно так же для B, C, D."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Убери аккураси из таблицы!"}),s.jsx("div",{className:"answer",children:"A: Грем, это секция для вопросов."})]})]})}function H({ranking:n,isLoading:c,preferences:a}){const i=b(),l=q();return s.jsxs("div",{className:"ranking-list",children:[m.isEmpty(n)&&!c&&"ничего не найдено",c&&s.jsx(p,{}),!c&&s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"place",children:i.RANK}),s.jsx("th",{children:i.EXP}),s.jsx("th",{className:"name",children:i.NAME}),s.jsx("th",{className:"name name-piu",children:i.AMPASS}),s.jsx("th",{className:"rating",children:"pp"}),s.jsx("th",{className:"playcount",children:i.PLAYCOUNT}),s.jsx("th",{className:"playcount",children:i.SCORES_count}),s.jsx("th",{className:"accuracy",children:i.ACCURACY}),s.jsx("th",{className:"hide-col",children:" "})]})}),s.jsx("tbody",{children:n.map((e,d)=>{const r=a==null?void 0:a.playersHiddenStatus[e.id];return r&&!(a!=null&&a.showHiddenPlayersInRanking)?null:s.jsxs("tr",{className:R("player",{"hidden-player":r}),children:[s.jsx("td",{className:"place",children:d===0?s.jsx(y,{}):`#${d+1}`}),s.jsx("td",{children:e.exp!=null?s.jsx(E,{exp:e.exp}):null}),s.jsx("td",{className:"name",children:s.jsxs("div",{className:"name-container",children:[s.jsx(P,{region:e.region}),s.jsx(j,{exact:!0,to:N.profile.getPath({id:e.id}),children:e.nickname})]})}),s.jsx("td",{className:"name name-piu",children:s.jsx(j,{exact:!0,to:N.profile.getPath({id:e.id}),children:e.arcade_name})}),s.jsx("td",{className:"rating secondary",children:Math.floor(e.pp)}),s.jsx("td",{className:"playcount",children:e.results_count}),s.jsx("td",{className:"playcount",children:e.best_results_count}),s.jsx("td",{className:"accuracy",children:e.accuracy?`${e.accuracy.toFixed(2)}%`:""}),s.jsx("td",{className:"hide-col",children:s.jsx(_,{onChange:()=>{l.mutate(m.set(["playersHiddenStatus",e.id],!r,a))},checked:!r})})]},e.id)})})]})]})}const U=()=>{var x;const n=b(),c=Q(),{isLoading:a,isFetching:i,error:l,data:e,refetch:d}=h.players.stats.useQuery(),r=q(),t=(x=c.data)==null?void 0:x.preferences,w=()=>{r.mutate(m.set(["showHiddenPlayersInRanking"],!t.showHiddenPlayersInRanking,t))},k=()=>{!a&&d()};return s.jsx("div",{className:"ranking-page",children:s.jsxs("div",{className:"content",children:[l&&l.message,s.jsxs("div",{className:"top-controls",children:[s.jsx("div",{className:"_flex-fill"}),s.jsxs(g,{children:[s.jsx(o,{index:!0,element:s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",disabled:!t,onClick:w,children:t!=null&&t.showHiddenPlayersInRanking?n.HIDE_UNSELECTED:n.SHOW_ALL}),s.jsx(v,{to:"faq",children:s.jsxs("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",children:[s.jsx(A,{})," faq"]})}),s.jsxs("button",{disabled:i,className:"btn btn-sm btn-dark btn-icon",onClick:k,children:[s.jsx(C,{})," ",n.UPDATE]})]})}),s.jsx(o,{path:"faq",element:s.jsx(v,{to:"..",children:s.jsx("button",{className:"btn btn-sm btn-dark btn-icon",children:"назад"})})})]})]}),s.jsxs(g,{children:[s.jsx(o,{index:!0,element:s.jsx(H,{ranking:e,isLoading:a,preferences:t})}),s.jsx(o,{path:"faq",element:s.jsx(S,{})})]})]})})};export{U as default};
//# sourceMappingURL=Ranking-f4268f7b.js.map
