import{r as T,a7 as n,d as B,b as k,j as a}from"./index-a5c9d038.js";import{R as u,B as f,T as S,X as x,Y as j,q as t,r as g,p as K,s as D}from"./BarChart-2e89ae07.js";const C="_historyTooltip_qks0d_1",h={historyTooltip:C},G=({playerId:c})=>B.players.grades.useQuery(c),p=({playerId:c})=>{const{data:r}=G({playerId:c});return T.useMemo(()=>{if(!r)return null;const{gradeCounts:s,totalCounts:l}=r;return n.flow(n.groupBy("level"),e=>n.values(e),n.map(e=>{const{level:i}=e[0],o=n.filter(m=>m.level===i,s),d=n.groupBy(m=>`${m.type}-${m.grade}`,o),y=n.groupBy("type",o),v=n.groupBy("grade",o),A=n.mapValues(n.sumBy("count"),n.groupBy("type",e)),I=n.sum(n.values(A)),b=n.sumBy("count",o);return{level:i,totalChartsByType:A,totalCharts:I,totalPlayedCharts:b,byTypeGrade:n.mapValues(n.sumBy("count"),d),byGrade:n.mapValues(n.sumBy("count"),v),byType:n.mapValues(n.sumBy("count"),y)}}))(l)},[r])},$=()=>{const c=k(),r=p({playerId:c.id?Number(c.id):void 0});if(!r)return null;const s=(l,e)=>i=>(l==="D"?-100:100)*(i.byTypeGrade[`${l}-${e}`]??0)/i.totalChartsByType[l];return a.jsx(u,{aspect:.74,children:a.jsxs(f,{data:r,margin:{top:5,bottom:5,right:5,left:0},stackOffset:"sign",children:[a.jsx(S,{isAnimationActive:!1,content:({payload:l})=>{if(!l||!l[0])return null;const e=l[0].payload,i=l.filter(d=>{var y;return d.value&&((y=d.name)==null?void 0:y.startsWith("S-"))}),o=l.filter(d=>{var y;return d.value&&((y=d.name)==null?void 0:y.startsWith("D-"))});return a.jsxs("div",{className:h.historyTooltip,children:[a.jsxs("div",{children:["Level: ",e.level]}),!!i.length&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Singles: (total ",e.totalChartsByType.S,")"]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, min-content)",gap:"0 0.5em"},children:i.map(d=>d.name?a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"subgrid",fontWeight:"bold",color:d.color,gridColumn:"1/4"},children:[a.jsxs("span",{children:[d.name.slice(2),": "]}),a.jsx("span",{children:d.value?`${d.value.toFixed(1)}%`:null}),a.jsxs("span",{children:["(",e.byTypeGrade[d.name]??0,")"]})]},d.name):null)})]}),!!o.length&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Doubles: (total ",e.totalChartsByType.D,")"]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, min-content)",gap:"0 0.5em"},children:o.map(d=>d.name?a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"subgrid",fontWeight:"bold",color:d.color,gridColumn:"1/4"},children:[a.jsxs("span",{children:[d.name.slice(2),": "]}),a.jsx("span",{children:d.value?`${(-d.value).toFixed(1)}%`:null}),a.jsxs("span",{children:["(",e.byTypeGrade[d.name]??0,")"]})]},d.name):null)})]})]})}}),a.jsx(x,{dataKey:"level"}),a.jsx(j,{tickFormatter:l=>`${Math.round(Math.abs(l))}%`,width:40,domain:([l,e])=>[Math.min(l,-10),Math.max(10,e)]}),a.jsx(t,{name:"D-SSS+",dataKey:s("D","SSS+"),fill:"#32f1f1",stackId:"stack"}),a.jsx(t,{name:"D-SSS",dataKey:s("D","SSS"),fill:"#16d4d4",stackId:"stack"}),a.jsx(t,{name:"D-SS+",dataKey:s("D","SS+"),fill:"#ffd900",stackId:"stack"}),a.jsx(t,{name:"D-SS",dataKey:s("D","SS"),fill:"#debc00",stackId:"stack"}),a.jsx(t,{name:"D-S+",dataKey:s("D","S+"),fill:"#c1a400",stackId:"stack"}),a.jsx(t,{name:"D-S",dataKey:s("D","S"),fill:"#a78e00",stackId:"stack"}),a.jsx(t,{name:"D-AAA+",dataKey:s("D","AAA+"),fill:"#c4cde0",stackId:"stack"}),a.jsx(t,{name:"D-AAA",dataKey:s("D","AAA"),fill:"#a2abb5",stackId:"stack"}),a.jsx(t,{name:"D-AA+",dataKey:s("D","AA+"),fill:"#c36134",stackId:"stack"}),a.jsx(t,{name:"D-AA",dataKey:s("D","AA"),fill:"#a85027",stackId:"stack"}),a.jsx(t,{name:"D-A+",dataKey:s("D","A+"),fill:"#7a4228",stackId:"stack"}),a.jsx(t,{name:"D-A",dataKey:s("D","A"),fill:"#5a3b2d",stackId:"stack"}),a.jsx(t,{name:"D-B",dataKey:s("D","B"),fill:"#6e5a83",stackId:"stack"}),a.jsx(t,{name:"D-C",dataKey:s("D","C"),fill:"#5f4f6f",stackId:"stack"}),a.jsx(t,{name:"D-D",dataKey:s("D","D"),fill:"#4a4155",stackId:"stack"}),a.jsx(t,{name:"D-F",dataKey:s("D","F"),fill:"#480404",stackId:"stack"}),a.jsx(t,{name:"S-SSS+",dataKey:s("S","SSS+"),fill:"#32f1f1",stackId:"stack"}),a.jsx(t,{name:"S-SSS",dataKey:s("S","SSS"),fill:"#16d4d4",stackId:"stack"}),a.jsx(t,{name:"S-SS+",dataKey:s("S","SS+"),fill:"#ffd900",stackId:"stack"}),a.jsx(t,{name:"S-SS",dataKey:s("S","SS"),fill:"#debc00",stackId:"stack"}),a.jsx(t,{name:"S-S+",dataKey:s("S","S+"),fill:"#c1a400",stackId:"stack"}),a.jsx(t,{name:"S-S",dataKey:s("S","S"),fill:"#a78e00",stackId:"stack"}),a.jsx(t,{name:"S-AAA+",dataKey:s("S","AAA+"),fill:"#c4cde0",stackId:"stack"}),a.jsx(t,{name:"S-AAA",dataKey:s("S","AAA"),fill:"#a2abb5",stackId:"stack"}),a.jsx(t,{name:"S-AA+",dataKey:s("S","AA+"),fill:"#c36134",stackId:"stack"}),a.jsx(t,{name:"S-AA",dataKey:s("S","AA"),fill:"#a85027",stackId:"stack"}),a.jsx(t,{name:"S-A+",dataKey:s("S","A+"),fill:"#7a4228",stackId:"stack"}),a.jsx(t,{name:"S-A",dataKey:s("S","A"),fill:"#5a3b2d",stackId:"stack"}),a.jsx(t,{name:"S-B",dataKey:s("S","B"),fill:"#6e5a83",stackId:"stack"}),a.jsx(t,{name:"S-C",dataKey:s("S","C"),fill:"#5f4f6f",stackId:"stack"}),a.jsx(t,{name:"S-D",dataKey:s("S","D"),fill:"#4a4155",stackId:"stack"}),a.jsx(t,{name:"S-F",dataKey:s("S","F"),fill:"#480404",stackId:"stack"}),a.jsx(g,{value:"Double",offset:0,position:"insideBottomLeft"}),a.jsx(g,{value:"Single",offset:0,position:"insideTopLeft"}),a.jsx(K,{y:0,stroke:"#bbb"})]})})},L=()=>{const c=k(),r=p({playerId:c.id?Number(c.id):void 0});return r?a.jsx(u,{aspect:1.6,children:a.jsxs(f,{data:r,stackOffset:"sign",margin:{top:5,bottom:5,right:5,left:0},children:[a.jsx(S,{isAnimationActive:!1,content:({payload:s})=>{if(!s||!s[0])return null;const l=s[0].payload,e=l.totalChartsByType.D??0,i=l.totalChartsByType.S??0;return a.jsxs("div",{className:h.historyTooltip,children:[a.jsxs("div",{children:["Level: ",l.level]}),i>0&&s[1].value!=null&&a.jsxs("div",{style:{fontWeight:"bold",color:s[1].color},children:["Single: ",Math.abs(s[1].value).toFixed(1),"% (",Math.round(s[1].value*i/100),"/",i,")"]}),e>0&&s[0].value!=null&&a.jsxs("div",{style:{fontWeight:"bold",color:s[0].color},children:["Double: ",Math.abs(s[0].value).toFixed(1),"% (",Math.round(Math.abs(s[0].value)*e/100),"/",e,")"]})]})}}),a.jsx(x,{dataKey:"level"}),a.jsx(j,{tickFormatter:s=>Math.round(Math.abs(s))+"%",width:40,domain:([s,l])=>[Math.min(s,-10),Math.max(10,l)]}),a.jsx(S,{}),a.jsx(K,{y:0,stroke:"#555"}),a.jsx(D,{}),a.jsx(t,{name:"D",dataKey:s=>-100*(s.byType.D??0)/(s.totalChartsByType.D??1),fill:"var(--double_chart_color)",stackId:"stack"}),a.jsx(t,{name:"S",dataKey:s=>100*(s.byType.S??0)/(s.totalChartsByType.S??1),fill:"var(--single_chart_color)",stackId:"stack"})]})}):null},_=()=>{const c=k(),r=p({playerId:c.id?Number(c.id):void 0});if(!r)return null;const s=l=>e=>100*(e.byGrade[l]??0)/e.totalPlayedCharts;return a.jsx(u,{aspect:1.6,children:a.jsxs(f,{stackOffset:"sign",data:r,margin:{top:5,bottom:5,right:5,left:0},children:[a.jsx(S,{isAnimationActive:!1,content:({payload:l})=>!l||!l[0]?null:a.jsxs("div",{className:h.historyTooltip,children:[a.jsxs("div",{children:["Level: ",l[0].payload.level]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, min-content)",gap:"0 0.5em"},children:l.filter(e=>e.value).map(e=>a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"subgrid",fontWeight:"bold",color:e.color,gridColumn:"1/4"},children:[a.jsxs("span",{children:[e.name,": "]}),a.jsxs("span",{children:[e.dataKey(e.payload).toFixed(1),"%"]}),a.jsx("span",{children:e.name?e.payload.byGrade[e.name]??0:null})]},e.name))})]})}),a.jsx(x,{dataKey:"level"}),a.jsx(j,{domain:[0,100],ticks:[0,50,100],tickFormatter:l=>`${Math.round(l)}%`,width:40}),a.jsx(D,{}),a.jsx(t,{name:"SSS+",dataKey:s("SSS+"),fill:"#0cd8d8",stackId:"stack"}),a.jsx(t,{name:"SSS",dataKey:s("SSS"),fill:"#13adad",stackId:"stack"}),a.jsx(t,{name:"SS+",dataKey:s("SS+"),fill:"#ffd900",stackId:"stack"}),a.jsx(t,{name:"SS",dataKey:s("SS"),fill:"#debc00",stackId:"stack"}),a.jsx(t,{name:"S+",dataKey:s("S+"),fill:"#c1a400",stackId:"stack"}),a.jsx(t,{name:"S",dataKey:s("S"),fill:"#a78e00",stackId:"stack"}),a.jsx(t,{name:"AAA+",dataKey:s("AAA+"),fill:"#c4cde0",stackId:"stack"}),a.jsx(t,{name:"AAA",dataKey:s("AAA"),fill:"#a2abb5",stackId:"stack"}),a.jsx(t,{name:"AA+",dataKey:s("AA+"),fill:"#c36134",stackId:"stack"}),a.jsx(t,{name:"AA",dataKey:s("AA"),fill:"#a85027",stackId:"stack"}),a.jsx(t,{name:"A+",dataKey:s("A+"),fill:"#7a4228",stackId:"stack"}),a.jsx(t,{name:"A",dataKey:s("A"),fill:"#5a3b2d",stackId:"stack"}),a.jsx(t,{name:"B",dataKey:s("B"),fill:"#6e5a83",stackId:"stack"}),a.jsx(t,{name:"C",dataKey:s("C"),fill:"#5f4f6f",stackId:"stack"}),a.jsx(t,{name:"D",dataKey:s("D"),fill:"#4a4155",stackId:"stack"}),a.jsx(t,{name:"F",dataKey:s("F"),fill:"#480404",stackId:"stack"})]})})};export{L as D,$ as G,_ as a};
//# sourceMappingURL=GradesGraph-587b8a2f.js.map
