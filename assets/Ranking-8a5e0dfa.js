import{c as f,d as x,g as j,j as s,u as k,a7 as u,Q as A,an as y,N as g,e as p,ao as v,ap as h,a2 as b,aq as R,S as C}from"./index-c67b0978.js";import{u as Q}from"./useUser-bffb1e67.js";import{c as E}from"./index-23782550.js";import{F as z}from"./index-8f798de2.js";import{T as M}from"./Toggle-12b05d7c.js";const _=()=>{const o=f();return x.user.preferencesMutation.useMutation({onSuccess:n=>{o.setQueryData(j(x.user.current,void 0,"query"),n),o.invalidateQueries(j(x.charts.search))}})};function P(){return s.jsxs("div",{className:"faq",children:[s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Как считается рейтинг?"}),s.jsxs("div",{className:"answer",children:["A: Используется ",s.jsx("a",{href:"https://en.wikipedia.org/wiki/Elo_rating_system",children:"рейтинг Эло"}),", широко используемый в шахматах и других играх, слегка модицированный под условия игры на пампе. Средний рейтинг - 1000. Коэффициент К зависит от уровня чарта (более сложные чарты сильнее влияют на рейтинг). Количество очков влияет на заработанный рейтинг (маленький отрыв от противника не даст так много очков как большой отрыв)."]})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Что такое рр и чем оно отличается от эло?"}),s.jsxs("div",{className:"answer",children:["A: РР (performance points) - система очков, взятая из osu!. Эло - система рейтинга, взятая из шахмат. Основные отличия:",s.jsx("br",{}),"С эло твои очки зависят от других игроков на этом чарте, с рр твои очки зависят только от того, как ты сыграешь чарт.",s.jsx("br",{}),"С эло можно потерять очки или заставить другого игрока их потерять, с рр можно только набирать больше очков.",s.jsx("br",{}),"С эло намного проще кого-то обогнать, с рр люди редко меняются местами в рейтинге.",s.jsx("br",{}),"Эло показывает кто кого обыгрывает в последнее время, а рр показывает, кто на каком примерно уровне по скиллу.",s.jsx("br",{}),"Сейчас рейтинг сортируется по Эло. РР выступает в качестве дополнительной инфы для интереса, плюс используется как стартовое значение Эло."]})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Система Эло используется для игр 1 на 1, как она используется на пампе, где на одном чарте играет много игроков?"}),s.jsx("div",{className:"answer",children:"A: Рекорды на одном чарте делятся на несколько игр 1 на 1. Если есть 3 игрока: A, B, C; то считается, что было 3 отдельные игры: A vs B, A vs C, B vs C."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Как считается сумма рр?"}),s.jsx("div",{className:"answer",children:"A: Сначала все скоры игрока сортируются по рр. Затем в общую сумму рр добавляется 100% от лучшего скора, 95% от второго скора, 90% от третьего, 86% от 4-го и так далее. (Формула коэффициента - 0.95^N). Таким образом, на общую сумму рр больше всего влияют самые лучшие результаты человека за всё время, и чтобы поднять свой уровень рр, нужно получать новые топовые результаты (и поднимать свой скилл)."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Учитываются ли рекорды на ранке в рейтинге?"}),s.jsx("div",{className:"answer",children:"A: Да. Как минимум потому что у нас есть много рекордов, взятых с машин бестов, и мы не знаем наверняка, на ранке они или нет. Если у игрока в топе есть два скора - на ранке и без ранка, используется тот, где больше очков."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Почему меня нет в рейтинге?"}),s.jsx("div",{className:"answer",children:"A: В таблицу попадают только те, у кого есть хотя бы 20 игр 1 на 1. Первые 20 игр используются для определения изначального рейтинга."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Почему суммарное количество оценок S-A-B не совпадает с общим количеством скоров?"}),s.jsx("div",{className:"answer",children:"A: Не для каждого результата известна оценка."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Если у меня есть несколько рекордов на А, несколько на А+, как считается суммарное количество грейдов в таблице?"}),s.jsx("div",{className:"answer",children:"A: В каждой колонке учитываются обе буквы - и треснутые, и с удержанным лайфом. То есть и А, и А+ идут в колонку А. Точно так же для B, C, D."})]}),s.jsxs("div",{className:"question-answer",children:[s.jsx("div",{className:"question",children:"Q: Убери аккураси из таблицы!"}),s.jsx("div",{className:"answer",children:"A: Грем, это секция для вопросов."})]})]})}const S="_expRank_yaecv_1",H="_green_yaecv_5",L="_gold_yaecv_9",F="_silver_yaecv_13",$="_bronze_yaecv_17",I="_purple_yaecv_21",e={expRank:S,green:H,gold:L,silver:F,bronze:$,purple:I},m=[{threshold:0,iconName:"0.png",color:e.bronze},{threshold:1e3,iconName:"1.png",color:e.bronze},{threshold:2e3,iconName:"2.png",color:e.bronze},{threshold:3e3,iconName:"3.png",color:e.bronze},{threshold:4e3,iconName:"4.png",color:e.bronze},{threshold:5e3,iconName:"5.png",color:e.bronze},{threshold:6250,iconName:"6.png",color:e.bronze},{threshold:7500,iconName:"7.png",color:e.bronze},{threshold:8750,iconName:"8.png",color:e.bronze},{threshold:1e4,iconName:"9.png",color:e.silver},{threshold:12e3,iconName:"10.png",color:e.silver},{threshold:14e3,iconName:"11.png",color:e.silver},{threshold:16e3,iconName:"12.png",color:e.silver},{threshold:18e3,iconName:"13.png",color:e.silver},{threshold:22e3,iconName:"14.png",color:e.silver},{threshold:26e3,iconName:"15.png",color:e.silver},{threshold:3e4,iconName:"16.png",color:e.silver},{threshold:35e3,iconName:"17.png",color:e.silver},{threshold:4e4,iconName:"18.png",color:e.gold},{threshold:5e4,iconName:"19.png",color:e.gold},{threshold:6e4,iconName:"20.png",color:e.gold},{threshold:7e4,iconName:"21.png",color:e.gold},{threshold:8e4,iconName:"22.png",color:e.gold},{threshold:1e5,iconName:"23.png",color:e.gold},{threshold:12e4,iconName:"24.png",color:e.gold},{threshold:14e4,iconName:"25.png",color:e.gold},{threshold:16e4,iconName:"26.png",color:e.gold},{threshold:2e5,iconName:"27.png",color:e.green},{threshold:25e4,iconName:"28.png",color:e.purple},{threshold:3e5,iconName:"29.png",color:e.purple}],B=({exp:o})=>{const c=o?m.findLastIndex(l=>l.threshold<=o):0,n=m[c];if(!n)return null;const r=o?`${Math.floor(o)}`+(c<m.length-1?` (${m[c+1].threshold-Math.floor(o)} to next rank)`:""):"N/A";return s.jsx("img",{className:`${n.color} ${e.expRank}`,src:`/ranks/${n.iconName}`,title:r,alt:`Exp: ${n.threshold}`})};function D({ranking:o,isLoading:c,preferences:n}){const r=k(),l=_();return s.jsxs("div",{className:"ranking-list",children:[u.isEmpty(o)&&!c&&"ничего не найдено",c&&s.jsx(A,{}),!c&&s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"place",children:r.RANK}),s.jsx("th",{children:r.EXP}),s.jsx("th",{className:"name",children:r.NAME}),s.jsx("th",{className:"name name-piu",children:r.AMPASS}),s.jsx("th",{className:"rating",children:"pp"}),s.jsx("th",{className:"playcount",children:r.PLAYCOUNT}),s.jsx("th",{className:"playcount",children:r.SCORES_count}),s.jsx("th",{className:"accuracy",children:r.ACCURACY}),s.jsx("th",{className:"hide-col",children:" "})]})}),s.jsx("tbody",{children:o.map((a,d)=>{const t=n==null?void 0:n.playersHiddenStatus[a.id];return t&&!(n!=null&&n.showHiddenPlayersInRanking)?null:s.jsxs("tr",{className:E("player",{"hidden-player":t}),children:[s.jsx("td",{className:"place",children:d===0?s.jsx(y,{}):`#${d+1}`}),s.jsx("td",{children:s.jsx(B,{exp:a.exp})}),s.jsx("td",{className:"name",children:s.jsxs("div",{className:"name-container",children:[s.jsx(z,{region:a.region}),s.jsx(g,{exact:!0,to:p.profile.getPath({id:a.id}),children:a.nickname})]})}),s.jsx("td",{className:"name name-piu",children:s.jsx(g,{exact:!0,to:p.profile.getPath({id:a.id}),children:a.arcade_name})}),s.jsx("td",{className:"rating secondary",children:Math.floor(a.pp)}),s.jsx("td",{className:"playcount",children:a.results_count}),s.jsx("td",{className:"playcount",children:a.best_results_count}),s.jsx("td",{className:"accuracy",children:a.accuracy?`${a.accuracy.toFixed(2)}%`:""}),s.jsx("td",{className:"hide-col",children:s.jsx(M,{onChange:()=>{l.mutate(u.set(["playersHiddenStatus",a.id],!t,n))},checked:!t})})]},a.id)})})]})]})}const G=()=>{var N;const o=k(),c=Q(),{isLoading:n,isFetching:r,error:l,data:a,refetch:d}=x.players.stats.useQuery(),t=_(),i=(N=c.data)==null?void 0:N.preferences,q=()=>{t.mutate(u.set(["showHiddenPlayersInRanking"],!i.showHiddenPlayersInRanking,i))},w=()=>{!n&&d()};return s.jsx("div",{className:"ranking-page",children:s.jsxs("div",{className:"content",children:[l&&l.message,s.jsxs("div",{className:"top-controls",children:[s.jsx("div",{className:"_flex-fill"}),s.jsxs(v,{children:[s.jsx(h,{index:!0,element:s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",disabled:!i,onClick:q,children:i!=null&&i.showHiddenPlayersInRanking?o.HIDE_UNSELECTED:o.SHOW_ALL}),s.jsx(b,{to:"faq",children:s.jsxs("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",children:[s.jsx(R,{})," faq"]})}),s.jsxs("button",{disabled:r,className:"btn btn-sm btn-dark btn-icon",onClick:w,children:[s.jsx(C,{})," ",o.UPDATE]})]})}),s.jsx(h,{path:"faq",element:s.jsx(b,{to:"..",children:s.jsx("button",{className:"btn btn-sm btn-dark btn-icon",children:"назад"})})})]})]}),s.jsxs(v,{children:[s.jsx(h,{index:!0,element:s.jsx(D,{ranking:a,isLoading:n,preferences:i})}),s.jsx(h,{path:"faq",element:s.jsx(P,{})})]})]})})};export{G as default};
//# sourceMappingURL=Ranking-8a5e0dfa.js.map
