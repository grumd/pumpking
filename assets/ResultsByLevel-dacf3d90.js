import{a4 as s,ao as B,a as k,b as P,u as E,r as L,ai as v,e as g,j as e,P as O,$ as T,ap as _,aq as I,N as w}from"./index-0ef7cbf5.js";import{c as y,S as D}from"./PlayerCompareSelect-28462da7.js";import{n as R}from"./numeral-1e0b41f3.js";import{p as C,G as N}from"./Profile-cf698ee1.js";import{C as G}from"./ChartLabel-28e2822b.js";import"./BarChart-a3538816.js";import"./usePlayers-ed9a0c91.js";import"./index-90441374.js";import"./Tooltip-a70a5681.js";import"./GradesGraph-ee6c6801.js";import"./ExpRankImg-3874ecc3.js";import"./Stack-cbf22778.js";import"./Toggle-c418315b.js";const U=y(l=>l.tracklist.data,l=>s.flow(s.get("chartLevels"),s.keys,s.filter(a=>0<a),s.map(a=>({label:a,value:a})))(l)),$=y(l=>l.results.sharedCharts,C,(l,a)=>a.params.level,(l,a)=>a.sortOrder,(l,a,n,m)=>{if(!a||!n)return null;const x=s.toString(n),c=s.flow(s.values,s.filter(t=>t.chartLevel===x&&!t.results.some(i=>i.playerId===a.id)),s.map(t=>({chart:t})),s.groupBy("chart.chartType"))(l);return{byType:s.flow(s.groupBy("chart.chartType"),t=>({...Object.keys(c).reduce((i,f)=>({...i,[f]:[]}),{}),...t}),s.mapValues(s.flow(s.groupBy("result.grade"),s.toPairs,s.orderBy(([t])=>B[t],m))),s.toPairs,s.orderBy(([t])=>t==="S"?0:t==="D"?1:2,"asc"),s.map(([t,i])=>m==="asc"?[t,[["X",c[t]||[]],...i]]:[t,[...i,["X",c[t]||[]]]]))(a.bestGradeResultsByLevel[n])}}),Z=()=>{const l=k(),a=P(),n=E(),[m,x]=L.useState("asc"),c=v(U),d=v(r=>C(r,{params:a})),t=v(r=>$(r,{params:a,sortOrder:m})),i=v(r=>r.charts.isLoading||r.results.isLoadingRanking||r.tracklist.isLoading);if(L.useEffect(()=>{if(d&&!a.level){const r=s.flow(s.get("resultsByLevel"),s.toPairs,s.maxBy("[1].length"),s.first)(d);l(g.profile.resultsByLevel.level.getPath({...a,level:r}))}},[a,d,l]),i)return e.jsx(O,{});if(!t)return null;const f={D:n.DOUBLES,S:n.SINGLES},b=r=>{l(g.profile.resultsByLevel.level.getPath({id:d.id,level:r}))};return e.jsxs("div",{className:"profile-results-by-level",children:[e.jsxs("header",{children:[e.jsx(T,{to:g.profile.getPath({id:d.id}),children:e.jsx("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",children:n.BACK_BUTTON})}),e.jsx("div",{className:"_flex-fill"}),e.jsxs("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:()=>x(r=>r==="asc"?"desc":"asc"),children:[m==="desc"?e.jsx(_,{}):e.jsx(I,{})," ",n.SORTING]}),e.jsx("button",{className:"btn btn-sm btn-dark _margin-right",disabled:a.level==="1",onClick:()=>b(Number(a.level)-1),children:"-"}),e.jsx(D,{className:"select levels _margin-right",classNamePrefix:"select",placeholder:n.LEVEL_PLACEHOLDER,options:c,value:c.find(r=>r.value===a.level),onChange:r=>b(r.value)}),e.jsx("button",{className:"btn btn-sm btn-dark",disabled:a.level==="28",onClick:()=>b(Number(a.level)+1),children:"+"})]}),e.jsx("div",{className:"chart-types",children:t.byType.map(([r,j])=>{const S=j.map(o=>o[1].length).reduce((o,u)=>o+u,0);return e.jsxs("div",{className:"chart-type",children:[e.jsx("header",{children:`${f[r]||r} (${S})`}),e.jsx("div",{className:"grades-groups",children:j.map(([o,u])=>s.isEmpty(u)?null:e.jsxs("div",{className:"grades-group",children:[e.jsxs("header",{children:[o==="X"?n.UNPLAYED:o==="?"?"?":e.jsx(N,{grade:o}),` (${u.length})`]}),e.jsx("div",{className:"charts-for-grade",children:u.map(({chart:p,result:h})=>e.jsxs("div",{className:"chart-block",children:[e.jsx(G,{type:p.chartType,level:p.chartLevel}),e.jsx(w,{exact:!0,to:g.leaderboard.sharedChart.getPath({sharedChartId:p.sharedChartId}),children:p.song}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"_flex-fill"}),e.jsx(N,{grade:o}),e.jsxs("span",{className:"score-span desktop-only",children:[h.scoreIncrease>h.score*.8&&"*",R(h.score).format("0,0")]})]})]},p.sharedChartId))})]},o))})]},r)})})]})};export{Z as default};
//# sourceMappingURL=ResultsByLevel-dacf3d90.js.map
