import{an as z,o as W,p as V,s as H,i as f,B as K,t as te,E as ae,D as re,k as ne,a3 as le,Y as D,ao as I,a2 as ie,a0 as oe,u as O,j as e,b as S,d as N,r as C,_ as o,G as de}from"./index-a8ec4dd6.js";import{r as _,E as L,g as ce}from"./ExpRankImg-3e1a766f.js";import{T as x,G as me}from"./Text-a69c1a5b.js";import{S as T}from"./Stack-e6399caa.js";import{R as v,B as w,T as g,X as A,Y as k,t as d,v as R,r as Q,w as X,p as Y,q as J,s as U}from"./BarChart-a8462810.js";function ue(r,n){return r in n.breakpoints?z(n.breakpoints[r]):z(r)}function pe(r,n){const t=r.map(s=>({value:s,px:ue(s,n)}));return t.sort((s,a)=>s.px-a.px),t}function M(r){return typeof r=="object"&&r!==null?"base"in r?r.base:void 0:r}var Z={root:"m-3eebeb36",label:"m-9e365f20"};const he={orientation:"horizontal"},xe=te((r,{color:n,variant:t,size:s})=>({root:{"--divider-color":n?ae(n,r):void 0,"--divider-border-style":t,"--divider-size":re(s,"divider-size")}})),G=W((r,n)=>{const t=V("Divider",he,r),{classNames:s,className:a,style:l,styles:c,unstyled:i,vars:h,color:y,orientation:p,label:m,labelPosition:u,mod:j,...b}=t,P=H({name:"Divider",classes:Z,props:t,className:a,style:l,classNames:s,styles:c,unstyled:i,vars:h,varsResolver:xe});return f.createElement(K,{ref:n,mod:[{orientation:p,"with-label":!!m},j],...P("root"),...b,role:"separator"},m&&f.createElement(K,{component:"span",mod:{position:u},...P("label")},m))});G.classes=Z;G.displayName="@mantine/core/Divider";function ye({spacing:r,verticalSpacing:n,cols:t,selector:s}){var p;const a=ne(),l=n===void 0?r:n,c=le({"--sg-spacing-x":D(M(r)),"--sg-spacing-y":D(M(l)),"--sg-cols":(p=M(t))==null?void 0:p.toString()}),i=I(a.breakpoints).reduce((m,u)=>(m[u]||(m[u]={}),typeof r=="object"&&r[u]!==void 0&&(m[u]["--sg-spacing-x"]=D(r[u])),typeof l=="object"&&l[u]!==void 0&&(m[u]["--sg-spacing-y"]=D(l[u])),typeof t=="object"&&t[u]!==void 0&&(m[u]["--sg-cols"]=t[u]),m),{}),y=pe(I(i),a).filter(m=>I(i[m.value]).length>0).map(m=>({query:`(min-width: ${a.breakpoints[m.value]})`,styles:i[m.value]}));return f.createElement(ie,{styles:c,media:y,selector:s})}var ee={root:"m-2415a157"};const je={cols:1,spacing:"md"},F=W((r,n)=>{const t=V("SimpleGrid",je,r),{classNames:s,className:a,style:l,styles:c,unstyled:i,vars:h,cols:y,verticalSpacing:p,spacing:m,...u}=t,j=H({name:"SimpleGrid",classes:ee,props:t,className:a,style:l,classNames:s,styles:c,unstyled:i,vars:h}),b=oe();return f.createElement(f.Fragment,null,f.createElement(ye,{...t,selector:`.${b}`}),f.createElement(K,{ref:n,...j("root",{className:b}),...u}))});F.classes=ee;F.displayName="@mantine/core/SimpleGrid";const fe="_expGrid_y40ee_1",ge={expGrid:fe},Ne=()=>{const r=O();return e.jsxs("article",{children:[e.jsx(x,{children:r.EXP_FAQ}),e.jsx(G,{my:"0.5em"}),e.jsx(x,{children:r.EXP_TITLES_LIST_HEADER}),e.jsx(G,{my:"0.5em"}),e.jsx(F,{cols:9,className:ge.expGrid,children:_.map((n,t)=>e.jsxs(T,{align:"center",gap:"0.25em",children:[e.jsx("div",{style:{width:"3em"},children:e.jsx(L,{rankIndex:t})}),e.jsx(x,{size:"xs",children:n.threshold})]},n.threshold))})]})},Se="_expLine_qee59_1",ve="_taken_qee59_7",Ae="_rest_qee59_12",ke="_expLineBlock_qee59_17",B={expLine:Se,taken:ve,rest:Ae,expLineBlock:ke},we=()=>{var y;const r=S(),n=O(),t=r.id?Number(r.id):void 0,{data:s}=N.players.stats.useQuery(),a=(y=s==null?void 0:s.find(p=>p.id===t))==null?void 0:y.exp;if(a==null)return null;const l=ce(a),c=_[l],i=_[l+1],h=i?(a-c.threshold)/((i==null?void 0:i.threshold)-c.threshold):1;return e.jsxs(me,{pl:"sm",pr:"sm",pb:"sm",fz:"lg",children:[e.jsxs(T,{align:"center",gap:"0.25em",w:"2.5em",children:[e.jsx(L,{rankIndex:l}),e.jsx(x,{size:"0.6rem",children:c.threshold})]}),e.jsxs(T,{align:"center",gap:"0",className:B.expLineBlock,children:[i?e.jsxs("span",{children:[e.jsx(x,{size:"sm",span:!0,c:"gold",children:Math.floor(a-c.threshold)}),e.jsxs(x,{size:"sm",span:!0,children:[" ","/ ",i.threshold-c.threshold]})]}):null,e.jsxs("div",{className:B.expLine,children:[e.jsx("div",{className:B.taken,style:{width:Math.floor(100*h)+"%"}}),e.jsx("div",{className:B.rest,style:{width:100-Math.ceil(100*h)+"%"}})]}),e.jsx("span",{children:e.jsxs(x,{size:"sm",span:!0,children:[n.TOTAL,":"," ",e.jsx(x,{span:!0,c:"gold",inherit:!0,children:a})]})})]}),i&&e.jsxs(T,{align:"center",gap:"0.25em",w:"2.5em",children:[e.jsx(L,{rankIndex:l+1}),e.jsx(x,{size:"0.6rem",children:i.threshold})]})]})},be="_historyTooltip_qks0d_1",$={historyTooltip:be},De=({playerId:r})=>N.players.grades.useQuery(r),E=({playerId:r})=>{const{data:n}=De({playerId:r});return C.useMemo(()=>{if(!n)return null;const{gradeCounts:t,totalCounts:s}=n;return o.flow(o.groupBy("level"),a=>o.values(a),o.map(a=>{const{level:l}=a[0],c=o.filter(j=>j.level===l,t),i=o.groupBy(j=>`${j.type}-${j.grade}`,c),h=o.groupBy("type",c),y=o.groupBy("grade",c),p=o.mapValues(o.sumBy("count"),o.groupBy("type",a)),m=o.sum(o.values(p)),u=o.sumBy("count",c);return{level:l,totalChartsByType:p,totalCharts:m,totalPlayedCharts:u,byTypeGrade:o.mapValues(o.sumBy("count"),i),byGrade:o.mapValues(o.sumBy("count"),y),byType:o.mapValues(o.sumBy("count"),h)}}))(s)},[n])},Be={"SSS+":"#32f1f1",SSS:"#16d4d4","SS+":"#ffd900",SS:"#debc00","S+":"#c1a400",S:"#a78e00","AAA+":"#c4cde0",AAA:"#a2abb5","AA+":"#c36134",AA:"#a85027","A+":"#7a4228",A:"#5a3b2d",B:"#6e5a83",C:"#5f4f6f",D:"#4a4155",F:"#480404"},q=[["S","SSS+"],["S","SSS"],["S","SS+"],["S","SS"],["S","S+"],["S","S"],["S","AAA+"],["S","AAA"],["S","AA+"],["S","AA"],["S","A+"],["S","A"],["S","B"],["S","C"],["S","D"],["S","F"],["D","SSS+"],["D","SSS"],["D","SS+"],["D","SS"],["D","S+"],["D","S"],["D","AAA+"],["D","AAA"],["D","AA+"],["D","AA"],["D","A+"],["D","A"],["D","B"],["D","C"],["D","D"],["D","F"]],Te=({payload:r})=>{if(!r||!r[0])return null;const n=r[0].payload,t=r.filter(a=>{var l;return a.value&&((l=a.name)==null?void 0:l.startsWith("S-"))}),s=r.filter(a=>{var l;return a.value&&((l=a.name)==null?void 0:l.startsWith("D-"))});return e.jsxs("div",{className:$.historyTooltip,children:[e.jsxs("div",{children:["Level: ",n.level]}),!!t.length&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Singles: (total ",n.totalChartsByType.S,")"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, min-content)",gap:"0 0.5em"},children:t.map(a=>a.name?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"subgrid",fontWeight:"bold",color:a.color,gridColumn:"1/4"},children:[e.jsxs("span",{children:[a.name.slice(2),": "]}),e.jsx("span",{children:a.value?`${a.value.toFixed(1)}%`:null}),e.jsxs("span",{children:["(",n.byTypeGrade[a.name]??0,")"]})]},a.name):null)})]}),!!s.length&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Doubles: (total ",n.totalChartsByType.D,")"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, min-content)",gap:"0 0.5em"},children:s.map(a=>a.name?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"subgrid",fontWeight:"bold",color:a.color,gridColumn:"1/4"},children:[e.jsxs("span",{children:[a.name.slice(2),": "]}),e.jsx("span",{children:a.value?`${(-a.value).toFixed(1)}%`:null}),e.jsxs("span",{children:["(",n.byTypeGrade[a.name]??0,")"]})]},a.name):null)})]})]})},Ge=r=>`${Math.round(Math.abs(r))}%`,Ce=([r,n])=>[Math.min(r,-10),Math.max(10,n)],Fe=()=>{const r=S(),n=E({playerId:r.id?Number(r.id):void 0}),t=C.useMemo(()=>n==null?void 0:n.map(s=>({...s,...q.reduce((a,[l,c])=>{const i=`${l}-${c}`;return{...a,[i]:(l==="D"?-100:100)*(s.byTypeGrade[i]??0)/s.totalChartsByType[l]}},{})})),[n]);return t?e.jsx(v,{aspect:.74,children:e.jsxs(w,{data:t,margin:{top:5,bottom:5,right:5,left:0},stackOffset:"sign",children:[e.jsx(g,{isAnimationActive:!1,content:Te}),e.jsx(A,{dataKey:"level"}),e.jsx(k,{tickFormatter:Ge,width:40,domain:Ce}),q.map(([s,a])=>e.jsx(d,{name:`${s}-${a}`,dataKey:`${s}-${a}`,fill:Be[a],stackId:"stack"},`${s}-${a}`)),e.jsx(R,{value:"Double",offset:0,position:"insideBottomLeft"}),e.jsx(R,{value:"Single",offset:0,position:"insideTopLeft"}),e.jsx(Q,{y:0,stroke:"#bbb"})]})}):null},$e=()=>{const r=S(),n=E({playerId:r.id?Number(r.id):void 0});return n?e.jsx(v,{aspect:1.6,children:e.jsxs(w,{data:n,stackOffset:"sign",margin:{top:5,bottom:5,right:5,left:0},children:[e.jsx(g,{isAnimationActive:!1,content:({payload:t})=>{if(!t||!t[0])return null;const s=t[0].payload,a=s.totalChartsByType.D??0,l=s.totalChartsByType.S??0;return e.jsxs("div",{className:$.historyTooltip,children:[e.jsxs("div",{children:["Level: ",s.level]}),l>0&&t[1].value!=null&&e.jsxs("div",{style:{fontWeight:"bold",color:t[1].color},children:["Single: ",Math.abs(t[1].value).toFixed(1),"% (",Math.round(t[1].value*l/100),"/",l,")"]}),a>0&&t[0].value!=null&&e.jsxs("div",{style:{fontWeight:"bold",color:t[0].color},children:["Double: ",Math.abs(t[0].value).toFixed(1),"% (",Math.round(Math.abs(t[0].value)*a/100),"/",a,")"]})]})}}),e.jsx(A,{dataKey:"level"}),e.jsx(k,{tickFormatter:t=>Math.round(Math.abs(t))+"%",width:40,domain:([t,s])=>[Math.min(t,-10),Math.max(10,s)]}),e.jsx(g,{}),e.jsx(Q,{y:0,stroke:"#555"}),e.jsx(X,{}),e.jsx(d,{name:"D",dataKey:t=>-100*(t.byType.D??0)/(t.totalChartsByType.D??1),fill:"var(--double_chart_color)",stackId:"stack"}),e.jsx(d,{name:"S",dataKey:t=>100*(t.byType.S??0)/(t.totalChartsByType.S??1),fill:"var(--single_chart_color)",stackId:"stack"})]})}):null},Ee=()=>{const r=S(),n=E({playerId:r.id?Number(r.id):void 0});if(!n)return null;const t=s=>a=>100*(a.byGrade[s]??0)/a.totalPlayedCharts;return e.jsx(v,{aspect:1.6,children:e.jsxs(w,{stackOffset:"sign",data:n,margin:{top:5,bottom:5,right:5,left:0},children:[e.jsx(g,{isAnimationActive:!1,content:({payload:s})=>!s||!s[0]?null:e.jsxs("div",{className:$.historyTooltip,children:[e.jsxs("div",{children:["Level: ",s[0].payload.level]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, min-content)",gap:"0 0.5em"},children:s.filter(a=>a.value).map(a=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"subgrid",fontWeight:"bold",color:a.color,gridColumn:"1/4"},children:[e.jsxs("span",{children:[a.name,": "]}),e.jsxs("span",{children:[a.dataKey(a.payload).toFixed(1),"%"]}),e.jsx("span",{children:a.name?a.payload.byGrade[a.name]??0:null})]},a.name))})]})}),e.jsx(A,{dataKey:"level"}),e.jsx(k,{domain:[0,100],ticks:[0,50,100],tickFormatter:s=>`${Math.round(s)}%`,width:40}),e.jsx(X,{}),e.jsx(d,{name:"SSS+",dataKey:t("SSS+"),fill:"#0cd8d8",stackId:"stack"}),e.jsx(d,{name:"SSS",dataKey:t("SSS"),fill:"#13adad",stackId:"stack"}),e.jsx(d,{name:"SS+",dataKey:t("SS+"),fill:"#ffd900",stackId:"stack"}),e.jsx(d,{name:"SS",dataKey:t("SS"),fill:"#debc00",stackId:"stack"}),e.jsx(d,{name:"S+",dataKey:t("S+"),fill:"#c1a400",stackId:"stack"}),e.jsx(d,{name:"S",dataKey:t("S"),fill:"#a78e00",stackId:"stack"}),e.jsx(d,{name:"AAA+",dataKey:t("AAA+"),fill:"#c4cde0",stackId:"stack"}),e.jsx(d,{name:"AAA",dataKey:t("AAA"),fill:"#a2abb5",stackId:"stack"}),e.jsx(d,{name:"AA+",dataKey:t("AA+"),fill:"#c36134",stackId:"stack"}),e.jsx(d,{name:"AA",dataKey:t("AA"),fill:"#a85027",stackId:"stack"}),e.jsx(d,{name:"A+",dataKey:t("A+"),fill:"#7a4228",stackId:"stack"}),e.jsx(d,{name:"A",dataKey:t("A"),fill:"#5a3b2d",stackId:"stack"}),e.jsx(d,{name:"B",dataKey:t("B"),fill:"#6e5a83",stackId:"stack"}),e.jsx(d,{name:"C",dataKey:t("C"),fill:"#5f4f6f",stackId:"stack"}),e.jsx(d,{name:"D",dataKey:t("D"),fill:"#4a4155",stackId:"stack"}),e.jsx(d,{name:"F",dataKey:t("F"),fill:"#480404",stackId:"stack"})]})})};function Pe(r){return de({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}}]})(r)}const se=({playerId:r})=>N.players.pp.useQuery(r),ze=()=>{const r=S(),{data:n}=se({playerId:r.id?Number(r.id):void 0}),t=C.useMemo(()=>n==null?void 0:n.history.map(s=>({date:new Date(s.date).getTime(),pp:parseFloat(s.pp)})),[n==null?void 0:n.history]);return t?e.jsx(v,{aspect:1.6,children:e.jsxs(Y,{data:t,margin:{top:5,bottom:5,right:5,left:0},children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:s=>new Date(s).toLocaleDateString()}),e.jsx(k,{allowDecimals:!1,domain:([s,a])=>[Math.max(0,s-100),a+100],tickFormatter:s=>`${Math.round(s)}`,width:40}),e.jsx(g,{isAnimationActive:!1,content:({payload:s})=>!s||!s[0]?null:e.jsxs("div",{className:"history-tooltip",children:[e.jsx("div",{children:new Date(s[0].payload.date).toLocaleDateString()}),s&&s[0]&&e.jsxs("div",{children:["PP: ",s[0].value]})]})}),e.jsx(U,{type:"monotone",isAnimationActive:!1,dataKey:"pp",stroke:"#88d3ff",strokeWidth:3,dot:!1})]})}):null},Re=()=>{const r=S(),{data:n}=se({playerId:r.id?Number(r.id):void 0}),t=C.useMemo(()=>n==null?void 0:n.rankHistory.map(s=>({date:new Date(s.date).getTime(),rank:s.rank})),[n==null?void 0:n.rankHistory]);return t?e.jsx(v,{aspect:1.6,children:e.jsxs(Y,{data:t,margin:{top:5,bottom:5,right:5,left:0},children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:s=>new Date(s).toLocaleDateString()}),e.jsx(k,{allowDecimals:!1,domain:([,s])=>[1,s<3?s+2:s+1],interval:0,reversed:!0,width:40}),e.jsx(g,{isAnimationActive:!1,content:({payload:s})=>!s||!s[0]?null:e.jsxs("div",{className:"history-tooltip",children:[e.jsx("div",{children:new Date(s[0].payload.date).toLocaleDateString()}),s&&s[0]&&e.jsxs("div",{children:["Place: #",s[0].value]})]})}),e.jsx(U,{isAnimationActive:!1,type:"stepAfter",dataKey:"rank",stroke:"#88d3ff",strokeWidth:3,dot:!1})]})}):null};export{$e as D,Ne as E,Fe as G,Pe as M,ze as P,F as S,Ee as a,we as b,Re as c,E as u};
//# sourceMappingURL=PpRankHistoryGraph-6fdae59f.js.map
